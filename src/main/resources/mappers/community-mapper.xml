<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC " -//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="community">
	<select id="getBoardList" resultType="CommunityDto">	<!-- 커뮤니티글 리스트 -->
		select c.board_id,c.title,c.writer,c.title,c.created_at,c.view_count,count(c.board_id) as like_count 
		from community c left join tbl_like l using (board_id) where activate_status='Y'
		group by c.board_id,c.writer,c.title,c.created_at,c.view_count
	</select>
	<select id="getSearchTitleBoardList" parameterType="string" resultType="CommunityDto">	<!-- 커뮤니티글 제목검색 리스트 -->
		select c.board_id,c.writer,title,c.created_at,c.view_count,count(board_id) as like_count 
		from community c left join tbl_like l using (board_id)
		where title like #{searchWord} and activate_status='Y'
		group by c.board_id,c.writer,c.title,c.created_at,c.view_count
	</select>
	<select id="getSearchNicknameBoardList" parameterType="string" resultType="CommunityDto">	<!-- 커뮤니티글 글쓴이 리스트 -->
		select c.board_id,c.writer,c.title,c.created_at,c.view_count,count(board_id) as like_count 
		from community c left join tbl_like l using (board_id)
		where nickname like #{searchWord} and activate_status='Y'
		group by c.board_id,c.writer,c.title,c.created_at,c.view_count
	</select>
	<select id="getSearchBoardList" parameterType="string" resultType="CommunityDto">	<!-- 커뮤니티글 제목+글쓴이 검색 리스트 -->
		select c.board_id,c.writer,c.title,c.created_at,c.view_count,count(board_id) as like_count 
		from community c left join tbl_like l using (board_id)
		where (title like #{searchWord} or nickname like #{searchWord}) and c.activate_status='Y'
		group by c.board_id,c.title,c.writer,c.title,c.created_at,c.view_count
	</select>
	
	<insert id="insertBoard" parameterType="CommunityDto">	<!-- 커뮤니티글 등록 -->
		insert into Community values("",writer,dong_id,title,content,"","",lat,lng,"")
	</insert>
	
	<select id="getBoard" parameterType="_int" resultType="CommunityDto"> <!-- 커뮤니티글 상세조회 -->
		select board_id,writer,dong_id,title,content,created_at,view_count,lat,lng from community where board_id=#{boardId}
	</select>
</mapper>
